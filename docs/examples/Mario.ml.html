<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.57 in css mode. -->
<html>
  <head>
    <title>Mario.ml</title>
    <style type="text/css">
    <!--
      body {
        color: #f5deb3;
        background-color: #2f4f4f;
        font-weight: bold;
      }
      .comment {
        /* font-lock-comment-face */
        color: #bebebe;
      }
      .comment-delimiter {
        /* font-lock-comment-delimiter-face */
        color: #bebebe;
      }
      .function-name {
        /* font-lock-function-name-face */
        color: #b2dfee;
      }
      .keyword {
        /* font-lock-keyword-face */
        color: #ffa500;
      }
      .number {
        /* font-lock-number-face */
        color: #cdcd00;
      }
      .punctuation {
        /* font-lock-punctuation-face */
        color: #00ffff;
      }
      .string {
        /* font-lock-string-face */
        color: #00cd00;
      }
      .tuareg-font-lock-governing {
        /* tuareg-font-lock-governing-face */
        color: #f5deb3;
        font-weight: bold;
      }
      .tuareg-font-lock-module {
        /* tuareg-font-lock-module-face */
        color: #98fb98;
      }
      .tuareg-font-lock-operator {
        /* tuareg-font-lock-operator-face */
        color: #f0e68c;
      }
      .type {
        /* font-lock-type-face */
        color: #98fb98;
      }
      .variable-name {
        /* font-lock-variable-name-face */
        color: #9ac0cd;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
  </head>
  <body>
    <pre>
<span class="comment-delimiter">(* </span><span class="comment">from https://elm-lang.org/examples/mario</span><span class="comment-delimiter"> *)</span>
<span class="tuareg-font-lock-governing">open </span><span class="tuareg-font-lock-module">Playground</span>
<span class="tuareg-font-lock-governing">open </span><span class="tuareg-font-lock-module">Basics</span> <span class="comment-delimiter">(* </span><span class="comment">float arithmetics</span><span class="comment-delimiter"> *)</span>

<span class="tuareg-font-lock-governing">type</span> <span class="type">model</span> = <span class="punctuation">{</span>
  x: number<span class="punctuation">;</span>
  y: number<span class="punctuation">;</span>
  vx: number<span class="punctuation">;</span>
  vy: number<span class="punctuation">;</span>
  dir: string
<span class="punctuation">}</span>

<span class="tuareg-font-lock-governing">let</span> <span class="variable-name">initial_model</span> =
    <span class="punctuation">{</span> x = <span class="number">0</span>.<span class="punctuation">;</span>
      y = <span class="number">0</span>.<span class="punctuation">;</span>
      vx = <span class="number">0</span>.<span class="punctuation">;</span>
      vy = <span class="number">0</span>.<span class="punctuation">;</span>
      dir = <span class="string">"right"</span>
    <span class="punctuation">}</span>

<span class="tuareg-font-lock-governing">let</span> <span class="function-name">to_gif</span> <span class="variable-name">mario</span> =
  <span class="keyword">if</span> mario.y &gt; <span class="number">0</span>. <span class="keyword">then</span>
    <span class="string">"https://elm-lang.org/images/mario/jump/"</span> <span class="tuareg-font-lock-operator">^</span> mario.dir <span class="tuareg-font-lock-operator">^</span> <span class="string">".gif"</span>
  <span class="keyword">else</span> <span class="keyword">if</span> mario.vx &lt;&gt; <span class="number">0</span>. <span class="keyword">then</span>
    <span class="string">"https://elm-lang.org/images/mario/walk/"</span> <span class="tuareg-font-lock-operator">^</span> mario.dir <span class="tuareg-font-lock-operator">^</span> <span class="string">".gif"</span>
  <span class="keyword">else</span>
    <span class="string">"https://elm-lang.org/images/mario/stand/"</span> <span class="tuareg-font-lock-operator">^</span> mario.dir <span class="tuareg-font-lock-operator">^</span> <span class="string">".gif"</span>

<span class="tuareg-font-lock-governing">let</span> <span class="function-name">view</span> <span class="variable-name">computer</span> <span class="variable-name">mario</span> =
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">w</span> = computer.screen.width <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">h</span> = computer.screen.height <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">b</span> = computer.screen.bottom <span class="tuareg-font-lock-governing">in</span>

  <span class="punctuation">[</span> rectangle <span class="punctuation">(</span>rgb <span class="number">174</span> <span class="number">238</span> <span class="number">238</span><span class="punctuation">)</span> w h<span class="punctuation">;</span>
    rectangle <span class="punctuation">(</span>rgb <span class="number">74</span> <span class="number">163</span> <span class="number">41</span><span class="punctuation">)</span> w <span class="number">100</span>.
      <span class="tuareg-font-lock-operator">|&gt;</span> move_y b<span class="punctuation">;</span>
    image <span class="number">70</span>. <span class="number">70</span>. <span class="punctuation">(</span>to_gif mario<span class="punctuation">)</span>

      <span class="tuareg-font-lock-operator">|&gt;</span> move mario.x <span class="punctuation">(</span>b + <span class="number">76</span>. + mario.y<span class="punctuation">)</span>
  <span class="punctuation">]</span>


<span class="tuareg-font-lock-governing">let</span> <span class="function-name">update</span> <span class="variable-name">computer</span> <span class="variable-name">mario</span> =
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">dt</span> = <span class="number">1</span>.<span class="number">666</span> <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">vx</span> = to_x computer.keyboard <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">vy</span> =
      <span class="keyword">if</span> mario.y = <span class="number">0</span>. <span class="keyword">then</span>
        <span class="keyword">if</span> computer.keyboard.kup <span class="keyword">then</span> <span class="number">5</span>. <span class="keyword">else</span> <span class="number">0</span>.
      <span class="keyword">else</span>
        mario.vy - dt / <span class="number">8</span>.
  <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">x</span> = mario.x + dt * vx <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">y</span> = mario.y + dt * vy <span class="tuareg-font-lock-governing">in</span>
  <span class="punctuation">{</span> x<span class="punctuation">;</span>
    y = max <span class="number">0</span>. y<span class="punctuation">;</span>
    vx<span class="punctuation">;</span>
    vy<span class="punctuation">;</span>
    dir = <span class="keyword">if</span> vx = <span class="number">0</span>. <span class="keyword">then</span> mario.dir <span class="keyword">else</span> <span class="keyword">if</span> vx &lt; <span class="number">0</span>. <span class="keyword">then</span> <span class="string">"left"</span> <span class="keyword">else</span> <span class="string">"right"</span>
  <span class="punctuation">}</span>

<span class="tuareg-font-lock-governing">let</span> <span class="variable-name">app</span> = game view update initial_model

<span class="tuareg-font-lock-governing">let</span> <span class="variable-name">main</span> = <span class="tuareg-font-lock-module">Playground_platform.</span>run_app app

</pre>
  </body>
</html>
